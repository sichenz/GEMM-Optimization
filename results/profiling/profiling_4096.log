GEMM Benchmark Suite
====================

==PROF== Connected to process 2880080 (/scratch/sz4972/GEMM-Optimization/build_profile/benchmark_gemm)
GPU: NVIDIA H100 80GB HBM3
Compute Capability: 9.0

         Kernel   DType     M     N     K    Time(ms)      GFLOPSBandwidth(GB/s)
--------------------------------------------------------------------------------

Testing M=128, N=128, K=128
==ERROR== ERR_NVGPUCTRPERM - The user does not have permission to access NVIDIA GPU Performance Counters on the target device 0. For instructions on enabling permissions and to get more information see https://developer.nvidia.com/ERR_NVGPUCTRPERM
     Lab1_Tiled    FP32   128   128   128       0.174       24.05           1.13
   cuBLAS_SGEMM    FP32   128   128   128       0.036      116.06           5.44
cuBLAS_HGEMM_TensorCore    FP16   128   128   128       0.042      100.38           2.35
Lab2_TensorCore    FP16   128   128   128       0.037      114.05           2.67
Lab2_TensorCore_Optimized    FP16   128   128   128       0.036      115.09           2.70

Testing M=256, N=256, K=256
     Lab1_Tiled    FP32   256   256   256       0.175      191.52           4.49
   cuBLAS_SGEMM    FP32   256   256   256       0.085      396.94           9.30
cuBLAS_HGEMM_TensorCore    FP16   256   256   256       0.042      808.43           9.47
Lab2_TensorCore    FP16   256   256   256       0.054      625.68           7.33
Lab2_TensorCore_Optimized    FP16   256   256   256       0.051      657.93           7.71

Testing M=512, N=512, K=512
     Lab1_Tiled    FP32   512   512   512       0.173     1555.25          18.23
   cuBLAS_SGEMM    FP32   512   512   512       0.085     3148.11          36.89
cuBLAS_HGEMM_TensorCore    FP16   512   512   512       0.044     6120.84          35.86
Lab2_TensorCore    FP16   512   512   512       0.086     3126.81          18.32
Lab2_TensorCore_Optimized    FP16   512   512   512       0.085     3169.82          18.57

Testing M=1024, N=1024, K=1024
     Lab1_Tiled    FP32  1024  1024  1024       0.245     8754.89          51.30
   cuBLAS_SGEMM    FP32  1024  1024  1024       0.058    36891.25         216.16
cuBLAS_HGEMM_TensorCore    FP16  1024  1024  1024       0.117    18277.83          53.55
Lab2_TensorCore    FP16  1024  1024  1024       0.246     8727.11          25.57
Lab2_TensorCore_Optimized    FP16  1024  1024  1024       0.284     7553.69          22.13

Testing M=2048, N=2048, K=2048
     Lab1_Tiled    FP32  2048  2048  2048       1.883     9125.31          26.73
   cuBLAS_SGEMM    FP32  2048  2048  2048       0.343    50048.79         146.63
cuBLAS_HGEMM_TensorCore    FP16  2048  2048  2048       0.116   148413.48         217.40
Lab2_TensorCore    FP16  2048  2048  2048       1.969     8723.42          12.78
Lab2_TensorCore_Optimized    FP16  2048  2048  2048       2.117     8115.10          11.89

Testing M=4096, N=4096, K=4096
     Lab1_Tiled    FP32  4096  4096  4096      15.318     8972.10          13.14
   cuBLAS_SGEMM    FP32  4096  4096  4096       2.659    51694.15          75.72
cuBLAS_HGEMM_TensorCore    FP16  4096  4096  4096       0.177   776112.42         568.44
Lab2_TensorCore    FP16  4096  4096  4096      13.560    10135.72           7.42
Lab2_TensorCore_Optimized    FP16  4096  4096  4096      15.708     8749.59           6.41

Testing M=8192, N=8192, K=8192
     Lab1_Tiled    FP32  8192  8192  8192     121.271     9066.55           6.64
   cuBLAS_SGEMM    FP32  8192  8192  8192      21.260    51718.50          37.88
cuBLAS_HGEMM_TensorCore    FP16  8192  8192  8192       1.345   817685.05         299.45
Lab2_TensorCore    FP16  8192  8192  8192     107.179    10258.61           3.76
Lab2_TensorCore_Optimized    FP16  8192  8192  8192     124.840     8807.37           3.23

Testing M=4096, N=256, K=1024
     Lab1_Tiled    FP32  4096   256  1024       0.248     8673.81          88.94
   cuBLAS_SGEMM    FP32  4096   256  1024       0.092    23453.98         240.49
cuBLAS_HGEMM_TensorCore    FP16  4096   256  1024       0.044    48972.06         251.08
Lab2_TensorCore    FP16  4096   256  1024       0.252     8512.90          43.65
Lab2_TensorCore_Optimized    FP16  4096   256  1024       0.284     7560.71          38.76

Testing M=1024, N=4096, K=512
     Lab1_Tiled    FP32  1024  4096   512       0.481     8934.77          56.71
   cuBLAS_SGEMM    FP32  1024  4096   512       0.095    45412.10         288.26
cuBLAS_HGEMM_TensorCore    FP16  1024  4096   512       0.115    37260.97         118.26
Lab2_TensorCore    FP16  1024  4096   512       0.488     8798.16          27.92
Lab2_TensorCore_Optimized    FP16  1024  4096   512       0.565     7600.46          24.12

Testing M=2048, N=512, K=2048
     Lab1_Tiled    FP32  2048   512  2048       0.482     8910.13          52.21
   cuBLAS_SGEMM    FP32  2048   512  2048       0.100    42906.42         251.40
cuBLAS_HGEMM_TensorCore    FP16  2048   512  2048       0.116    37070.07         108.60
Lab2_TensorCore    FP16  2048   512  2048       0.469     9158.40          26.83
Lab2_TensorCore_Optimized    FP16  2048   512  2048       0.534     8047.62          23.58

Testing M=512, N=2048, K=512
     Lab1_Tiled    FP32   512  2048   512       0.188     5698.83          50.09
   cuBLAS_SGEMM    FP32   512  2048   512       0.036    29975.37         263.46
cuBLAS_HGEMM_TensorCore    FP16   512  2048   512       0.044    24412.99         107.28
Lab2_TensorCore    FP16   512  2048   512       0.135     7935.87          34.87
Lab2_TensorCore_Optimized    FP16   512  2048   512       0.154     6950.54          30.54
Results saved to results/benchmark_results.csv

Benchmark completed!

================================================================================
VALIDATING TENSORCORE CORRECTNESS
================================================================================

=== Validating TensorCore Correctness ===
Matrix size: 128x128x128
Max absolute difference: 0.04
Max relative difference: 0.00
Total mismatches: 0 / 16384
✓ Validation PASSED (tolerance: 0.01)

=== Validating TensorCore Correctness ===
Matrix size: 512x512x512
Max absolute difference: 0.37
Max relative difference: 0.00
Total mismatches: 0 / 262144
✓ Validation PASSED (tolerance: 0.01)

=== Validating TensorCore Correctness ===
Matrix size: 1024x1024x1024
Max absolute difference: 1.24
Max relative difference: 0.00
Total mismatches: 0 / 1048576
✓ Validation PASSED (tolerance: 0.01)

================================================================================
VALIDATION SUMMARY: 3 / 3 tests passed
================================================================================
==PROF== Disconnected from process 2880080
