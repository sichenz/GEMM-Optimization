GEMM Benchmark Suite
====================

==PROF== Connected to process 4055195 (/scratch/sz4972/GEMM-Optimization/build_profile/benchmark_gemm)
GPU: Tesla V100-PCIE-32GB
Compute Capability: 7.0

         Kernel   DType     M     N     K    Time(ms)      GFLOPSBandwidth(GB/s)
--------------------------------------------------------------------------------

Testing M=128, N=128, K=128
==ERROR== ERR_NVGPUCTRPERM - The user does not have permission to access NVIDIA GPU Performance Counters on the target device 0. For instructions on enabling permissions and to get more information see https://developer.nvidia.com/ERR_NVGPUCTRPERM
     Lab1_Tiled    FP32   128   128   128       0.236       17.78           0.83
   cuBLAS_SGEMM    FP32   128   128   128       0.128       32.89           1.54
cuBLAS_HGEMM_TensorCore    FP16   128   128   128       0.135       31.12           0.73

Testing M=256, N=256, K=256
     Lab1_Tiled    FP32   256   256   256       0.299      112.37           2.63
   cuBLAS_SGEMM    FP32   256   256   256       0.258      129.84           3.04
cuBLAS_HGEMM_TensorCore    FP16   256   256   256       0.135      248.40           2.91

Testing M=512, N=512, K=512
     Lab1_Tiled    FP32   512   512   512       0.316      850.12           9.96
   cuBLAS_SGEMM    FP32   512   512   512       0.129     2079.27          24.37
cuBLAS_HGEMM_TensorCore    FP16   512   512   512       0.128     2090.12          12.25

Testing M=1024, N=1024, K=1024
     Lab1_Tiled    FP32  1024  1024  1024       0.668     3215.20          18.84
   cuBLAS_SGEMM    FP32  1024  1024  1024       0.218     9873.31          57.85
cuBLAS_HGEMM_TensorCore    FP16  1024  1024  1024       0.130    16575.41          48.56

Testing M=2048, N=2048, K=2048
     Lab1_Tiled    FP32  2048  2048  2048       5.227     3287.02           9.63
   cuBLAS_SGEMM    FP32  2048  2048  2048       1.441    11923.73          34.93
cuBLAS_HGEMM_TensorCore    FP16  2048  2048  2048       0.229    74865.91         109.67

Testing M=4096, N=4096, K=4096
     Lab1_Tiled    FP32  4096  4096  4096      37.040     3710.54           5.44
   cuBLAS_SGEMM    FP32  4096  4096  4096      10.255    13401.80          19.63
cuBLAS_HGEMM_TensorCore    FP16  4096  4096  4096       1.483    92680.70          67.88

Testing M=8192, N=8192, K=8192
     Lab1_Tiled    FP32  8192  8192  8192     293.442     3746.95           2.74
   cuBLAS_SGEMM    FP32  8192  8192  8192      79.522    13826.53          10.13
cuBLAS_HGEMM_TensorCore    FP16  8192  8192  8192      11.069    99328.54          36.38

Testing M=4096, N=256, K=1024
     Lab1_Tiled    FP32  4096   256  1024       0.624     3442.18          35.30
   cuBLAS_SGEMM    FP32  4096   256  1024       0.211    10196.51         104.55
cuBLAS_HGEMM_TensorCore    FP16  4096   256  1024       0.130    16573.57          84.97

Testing M=1024, N=4096, K=512
     Lab1_Tiled    FP32  1024  4096   512       1.211     3546.64          22.51
   cuBLAS_SGEMM    FP32  1024  4096   512       0.408    10517.76          66.76
cuBLAS_HGEMM_TensorCore    FP16  1024  4096   512       0.137    31249.76          99.18

Testing M=2048, N=512, K=2048
     Lab1_Tiled    FP32  2048   512  2048       1.209     3553.85          20.82
   cuBLAS_SGEMM    FP32  2048   512  2048       0.382    11231.94          65.81
cuBLAS_HGEMM_TensorCore    FP16  2048   512  2048       0.131    32664.33          95.70

Testing M=512, N=2048, K=512
     Lab1_Tiled    FP32   512  2048   512       0.326     3291.41          28.93
   cuBLAS_SGEMM    FP32   512  2048   512       0.151     7131.05          62.68
cuBLAS_HGEMM_TensorCore    FP16   512  2048   512       0.126     8541.28          37.53
Results saved to results/benchmark_results.csv

Benchmark completed!
==PROF== Disconnected from process 4055195
